{"version":3,"file":"_server-CepNTIWa.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/_server.js"],"sourcesContent":["import { d as db, p as players } from \"../../chunks/schema.js\";\nimport { j as json } from \"../../chunks/index2.js\";\nimport { eq } from \"drizzle-orm\";\nimport fs from \"node:fs\";\nconst TEAMS_FILEPATH = \"./teams.json\";\nconst WIN_POINTS = 3;\nconst TIE_POINTS = 1;\nasync function POST({ request }) {\n  const { players: players2, tie, setTeams, teams } = await request.json();\n  if (players2) {\n    const points = tie ? TIE_POINTS : WIN_POINTS;\n    await win(players2, points);\n  } else if (teams) {\n    fs.writeFileSync(TEAMS_FILEPATH, JSON.stringify(teams), {\n      encoding: \"utf-8\"\n    });\n  }\n  return json(true);\n}\nasync function DELETE({ request }) {\n  await db.update(players).set({ points: 0 });\n  return json(true);\n}\nasync function win(wPlayers, points) {\n  for (const player of wPlayers) {\n    player.points += points;\n    await db.update(players).set(player).where(eq(players.id, player.id));\n  }\n}\nexport {\n  DELETE,\n  POST\n};\n"],"names":[],"mappings":";;;;;;;;;AAIA,MAAM,cAAc,GAAG,cAAc;AACrC,MAAM,UAAU,GAAG,CAAC;AACpB,MAAM,UAAU,GAAG,CAAC;AACpB,eAAe,IAAI,CAAC,EAAE,OAAO,EAAE,EAAE;AACjC,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE;AAC1E,EAAE,IAAI,QAAQ,EAAE;AAChB,IAAI,MAAM,MAAM,GAAG,GAAG,GAAG,UAAU,GAAG,UAAU;AAChD,IAAI,MAAM,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC;AAC/B,GAAG,MAAM,IAAI,KAAK,EAAE;AACpB,IAAI,EAAE,CAAC,aAAa,CAAC,cAAc,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE;AAC5D,MAAM,QAAQ,EAAE;AAChB,KAAK,CAAC;AACN;AACA,EAAE,OAAO,IAAI,CAAC,IAAI,CAAC;AACnB;AACA,eAAe,MAAM,CAAC,EAAE,OAAO,EAAE,EAAE;AACnC,EAAE,MAAM,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC;AAC7C,EAAE,OAAO,IAAI,CAAC,IAAI,CAAC;AACnB;AACA,eAAe,GAAG,CAAC,QAAQ,EAAE,MAAM,EAAE;AACrC,EAAE,KAAK,MAAM,MAAM,IAAI,QAAQ,EAAE;AACjC,IAAI,MAAM,CAAC,MAAM,IAAI,MAAM;AAC3B,IAAI,MAAM,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,OAAO,CAAC,EAAE,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC;AACzE;AACA;;;;"}